import React, {useEffect, useMemo, useState} from 'react';
import DataServiceClass from "./API/DataServiceClass.jsx";

const CitiesList = (props) => {

    // Тестовый массив, если не обходится CORS
    // const citiesLocal = {"searchContext":{"contentType":"city","query":"\u043e","withParent":"1"},"result":[{"id":"Free","name":"\u0411\u0435\u0441\u043f\u043b\u0430\u0442\u043d\u0430\u044f \u0432\u0435\u0440\u0441\u0438\u044f kladr-api.ru","zip":"100000","type":"","typeShort":"","okato":"","contentType":"city"},{"id":"1001000100000","name":"\u041e\u043b\u043e\u043d\u0435\u0446","zip":186000,"type":"\u0413\u043e\u0440\u043e\u0434","typeShort":"\u0433","okato":"86230501000","contentType":"city","guid":"38568ddc-20b7-409f-aa76-024b3b02c637","ifnsfl":"1035","ifnsul":"1035","oktmo":"86630101001","parentGuid":"84a77f19-908b-472b-b0e7-a95bb480d802","cadnum":"","parents":[{"id":"1000000000000","name":"\u041a\u0430\u0440\u0435\u043b\u0438\u044f","zip":185014,"type":"\u0420\u0435\u0441\u043f\u0443\u0431\u043b\u0438\u043a\u0430","typeShort":"\u0420\u0435\u0441\u043f","okato":"86000000000","contentType":"region","guid":"248d8071-06e1-425e-a1cf-d1ff4c4a14a8","ifnsfl":"1000","ifnsul":"1000","oktmo":"86000000","parentGuid":"","cadnum":""},{"id":"1001000000000","name":"\u041e\u043b\u043e\u043d\u0435\u0446\u043a\u0438\u0439","zip":186000,"type":"\u0420\u0430\u0439\u043e\u043d","typeShort":"\u0440-\u043d","okato":"86230000000","contentType":"district","guid":"84a77f19-908b-472b-b0e7-a95bb480d802","ifnsfl":"1035","ifnsul":"1035","oktmo":"","parentGuid":"248d8071-06e1-425e-a1cf-d1ff4c4a14a8","cadnum":""}]},{"id":"1402300100000","name":"\u041e\u043b\u0435\u043a\u043c\u0438\u043d\u0441\u043a","zip":678100,"type":"\u0413\u043e\u0440\u043e\u0434","typeShort":"\u0433","okato":"98241501000","contentType":"city","guid":"c3aba7f3-caf7-443f-a906-8d79e6ec37f6","ifnsfl":"1450","ifnsul":"1450","oktmo":"98641101001","parentGuid":"b90ae50a-ce7b-4b76-8af3-df3195e7ee23","cadnum":"","parents":[{"id":"1400000000000","name":"\u0421\u0430\u0445\u0430 \/\u042f\u043a\u0443\u0442\u0438\u044f\/","zip":677902,"type":"\u0420\u0435\u0441\u043f\u0443\u0431\u043b\u0438\u043a\u0430","typeShort":"\u0420\u0435\u0441\u043f","okato":"98000000000","contentType":"region","guid":"c225d3db-1db6-4063-ace0-b3fe9ea3805f","ifnsfl":"1400","ifnsul":"1400","oktmo":"98000000","parentGuid":"","cadnum":""},{"id":"1402300000000","name":"\u041e\u043b\u0435\u043a\u043c\u0438\u043d\u0441\u043a\u0438\u0439","zip":678109,"type":"\u0423\u043b\u0443\u0441","typeShort":"\u0443","okato":"98241000000","contentType":"district","guid":"b90ae50a-ce7b-4b76-8af3-df3195e7ee23","ifnsfl":"1450","ifnsul":"1450","oktmo":"98641000","parentGuid":"c225d3db-1db6-4063-ace0-b3fe9ea3805f","cadnum":""}]},{"id":"2901400100000","name":"\u041e\u043d\u0435\u0433\u0430","zip":164843,"type":"\u0413\u043e\u0440\u043e\u0434","typeShort":"\u0433.","okato":"11420000000","contentType":"city","guid":"53e6ddd5-a1fb-4444-89a4-3952ef6f114b","ifnsfl":"2920","ifnsul":"2920","oktmo":"11646101001","parentGuid":"e252789a-4375-4f4b-b83e-ae03de3f915c","cadnum":"","parents":[{"id":"2900000000000","name":"\u0410\u0440\u0445\u0430\u043d\u0433\u0435\u043b\u044c\u0441\u043a\u0430\u044f","zip":163055,"type":"\u041e\u0431\u043b\u0430\u0441\u0442\u044c","typeShort":"\u043e\u0431\u043b","okato":"11000000000","contentType":"region","guid":"294277aa-e25d-428c-95ad-46719c4ddb44","ifnsfl":"2900","ifnsul":"2900","oktmo":"11000000","parentGuid":"","cadnum":""},{"id":"2901400000000","name":"\u041e\u043d\u0435\u0436\u0441\u043a\u0438\u0439","zip":164899,"type":"\u0420\u0430\u0439\u043e\u043d","typeShort":"\u0440-\u043d","okato":"11246000000","contentType":"district","guid":"e252789a-4375-4f4b-b83e-ae03de3f915c","ifnsfl":"2920","ifnsul":"2920","oktmo":"11646000","parentGuid":"294277aa-e25d-428c-95ad-46719c4ddb44","cadnum":""}]},{"id":"3101400100000","name":"\u041d\u043e\u0432\u044b\u0439 \u041e\u0441\u043a\u043e\u043b","zip":309640,"type":"\u0413\u043e\u0440\u043e\u0434","typeShort":"\u0433","okato":"14244501000","contentType":"city","guid":"f565b329-4041-4fd2-aa0a-debd5f7c3857","ifnsfl":"3114","ifnsul":"3114","oktmo":"14735000001","parentGuid":"6abf96fc-7376-448f-bdce-816bb961d7b5","cadnum":"","parents":[{"id":"3100000000000","name":"\u0411\u0435\u043b\u0433\u043e\u0440\u043e\u0434\u0441\u043a\u0430\u044f","zip":308024,"type":"\u041e\u0431\u043b\u0430\u0441\u0442\u044c","typeShort":"\u043e\u0431\u043b","okato":"14000000000","contentType":"region","guid":"639efe9d-3fc8-4438-8e70-ec4f2321f2a7","ifnsfl":"3100","ifnsul":"3100","oktmo":"14000000","parentGuid":"","cadnum":""},{"id":"3101400000000","name":"\u041d\u043e\u0432\u043e\u043e\u0441\u043a\u043e\u043b\u044c\u0441\u043a\u0438\u0439","zip":309609,"type":"\u0420\u0430\u0439\u043e\u043d","typeShort":"\u0440-\u043d","okato":"14244000000","contentType":"district","guid":"6abf96fc-7376-448f-bdce-816bb961d7b5","ifnsfl":"3114","ifnsul":"3114","oktmo":"","parentGuid":"639efe9d-3fc8-4438-8e70-ec4f2321f2a7","cadnum":""}]},{"id":"3602000100000","name":"\u041e\u0441\u0442\u0440\u043e\u0433\u043e\u0436\u0441\u043a","zip":397855,"type":"\u0413\u043e\u0440\u043e\u0434","typeShort":"\u0433","okato":"20231501000","contentType":"city","guid":"8434550d-dd9b-4bc7-8e5b-d43a991753e2","ifnsfl":"3652","ifnsul":"3652","oktmo":"20631101001","parentGuid":"924d7c66-4d54-4285-a883-c9c301e7cb67","cadnum":"","parents":[{"id":"3600000000000","name":"\u0412\u043e\u0440\u043e\u043d\u0435\u0436\u0441\u043a\u0430\u044f","zip":394031,"type":"\u041e\u0431\u043b\u0430\u0441\u0442\u044c","typeShort":"\u043e\u0431\u043b","okato":"20000000000","contentType":"region","guid":"b756fe6b-bbd3-44d5-9302-5bfcc740f46e","ifnsfl":"3600","ifnsul":"3600","oktmo":"20000000","parentGuid":"","cadnum":""},{"id":"3602000000000","name":"\u041e\u0441\u0442\u0440\u043e\u0433\u043e\u0436\u0441\u043a\u0438\u0439","zip":397840,"type":"\u0420\u0430\u0439\u043e\u043d","typeShort":"\u0440-\u043d","okato":"20231000000","contentType":"district","guid":"924d7c66-4d54-4285-a883-c9c301e7cb67","ifnsfl":"3652","ifnsul":"3652","oktmo":"20631000","parentGuid":"b756fe6b-bbd3-44d5-9302-5bfcc740f46e","cadnum":""}]},{"id":"3901000100000","name":"\u041e\u0437\u0435\u0440\u0441\u043a","zip":238120,"type":"\u0413\u043e\u0440\u043e\u0434","typeShort":"\u0433","okato":"27227501000","contentType":"city","guid":"19620317-39e8-4a09-af7e-67b136ef61fe","ifnsfl":"3914","ifnsul":"3914","oktmo":"27716000001","parentGuid":"b3171d74-da95-4681-a564-2acd3de29f4e","cadnum":"","parents":[{"id":"3900000000000","name":"\u041a\u0430\u043b\u0438\u043d\u0438\u043d\u0433\u0440\u0430\u0434\u0441\u043a\u0430\u044f","zip":236016,"type":"\u041e\u0431\u043b\u0430\u0441\u0442\u044c","typeShort":"\u043e\u0431\u043b","okato":"27000000000","contentType":"region","guid":"90c7181e-724f-41b3-b6c6-bd3ec7ae3f30","ifnsfl":"3900","ifnsul":"3900","oktmo":"27000000","parentGuid":"","cadnum":""},{"id":"3901000000000","name":"\u041e\u0437\u0435\u0440\u0441\u043a\u0438\u0439","zip":238132,"type":"\u0420\u0430\u0439\u043e\u043d","typeShort":"\u0440-\u043d","okato":"27227000000","contentType":"district","guid":"b3171d74-da95-4681-a564-2acd3de29f4e","ifnsfl":"3914","ifnsul":"3914","oktmo":"27716000","parentGuid":"90c7181e-724f-41b3-b6c6-bd3ec7ae3f30","cadnum":""}]},{"id":"4302300100000","name":"\u041e\u043c\u0443\u0442\u043d\u0438\u043d\u0441\u043a","zip":612740,"type":"\u0413\u043e\u0440\u043e\u0434","typeShort":"\u0433","okato":"33228501000","contentType":"city","guid":"9039bbb5-93a8-4172-b97c-af2b9abbb614","ifnsfl":"4322","ifnsul":"4322","oktmo":"33628101001","parentGuid":"fbfb0f68-aa1c-414e-8c0f-cb548b87ee17","cadnum":"","parents":[{"id":"4300000000000","name":"\u041a\u0438\u0440\u043e\u0432\u0441\u043a\u0430\u044f","zip":610030,"type":"\u041e\u0431\u043b\u0430\u0441\u0442\u044c","typeShort":"\u043e\u0431\u043b","okato":"33000000000","contentType":"region","guid":"0b940b96-103f-4248-850c-26b6c7296728","ifnsfl":"4300","ifnsul":"4300","oktmo":"33000000","parentGuid":"","cadnum":""},{"id":"4302300000000","name":"\u041e\u043c\u0443\u0442\u043d\u0438\u043d\u0441\u043a\u0438\u0439","zip":612711,"type":"\u0420\u0430\u0439\u043e\u043d","typeShort":"\u0440-\u043d","okato":"33228000000","contentType":"district","guid":"fbfb0f68-aa1c-414e-8c0f-cb548b87ee17","ifnsfl":"4322","ifnsul":"4322","oktmo":"33628000","parentGuid":"0b940b96-103f-4248-850c-26b6c7296728","cadnum":""}]},{"id":"4302600100000","name":"\u041e\u0440\u043b\u043e\u0432","zip":612270,"type":"\u0413\u043e\u0440\u043e\u0434","typeShort":"\u0433","okato":"33245501000","contentType":"city","guid":"0302ec51-eea9-4343-9248-ce4878ca465e","ifnsfl":"4313","ifnsul":"4313","oktmo":"33645101001","parentGuid":"4b27f8d0-7b29-42db-8edc-9fc5f81d898a","cadnum":"","parents":[{"id":"4300000000000","name":"\u041a\u0438\u0440\u043e\u0432\u0441\u043a\u0430\u044f","zip":610030,"type":"\u041e\u0431\u043b\u0430\u0441\u0442\u044c","typeShort":"\u043e\u0431\u043b","okato":"33000000000","contentType":"region","guid":"0b940b96-103f-4248-850c-26b6c7296728","ifnsfl":"4300","ifnsul":"4300","oktmo":"33000000","parentGuid":"","cadnum":""},{"id":"4302600000000","name":"\u041e\u0440\u043b\u043e\u0432\u0441\u043a\u0438\u0439","zip":612275,"type":"\u0420\u0430\u0439\u043e\u043d","typeShort":"\u0440-\u043d","okato":"33245501000","contentType":"district","guid":"4b27f8d0-7b29-42db-8edc-9fc5f81d898a","ifnsfl":"4313","ifnsul":"4313","oktmo":"33645000","parentGuid":"0b940b96-103f-4248-850c-26b6c7296728","cadnum":""}]},{"id":"4601600100000","name":"\u041e\u0431\u043e\u044f\u043d\u044c","zip":306230,"type":"\u0413\u043e\u0440\u043e\u0434","typeShort":"\u0433","okato":"38226501000","contentType":"city","guid":"60d797fd-62b0-4705-9f5b-aa0a67c5c749","ifnsfl":"4619","ifnsul":"4619","oktmo":"38626101001","parentGuid":"df6cb32f-2d5b-48b0-959f-dcd4cc45980b","cadnum":"","parents":[{"id":"4600000000000","name":"\u041a\u0443\u0440\u0441\u043a\u0430\u044f","zip":305025,"type":"\u041e\u0431\u043b\u0430\u0441\u0442\u044c","typeShort":"\u043e\u0431\u043b","okato":"38000000000","contentType":"region","guid":"ee594d5e-30a9-40dc-b9f2-0add1be44ba1","ifnsfl":"4600","ifnsul":"4600","oktmo":"38000000","parentGuid":"","cadnum":""},{"id":"4601600000000","name":"\u041e\u0431\u043e\u044f\u043d\u0441\u043a\u0438\u0439","zip":306240,"type":"\u0420\u0430\u0439\u043e\u043d","typeShort":"\u0440-\u043d","okato":"38226000000","contentType":"district","guid":"df6cb32f-2d5b-48b0-959f-dcd4cc45980b","ifnsfl":"4619","ifnsul":"4619","oktmo":"","parentGuid":"ee594d5e-30a9-40dc-b9f2-0add1be44ba1","cadnum":""}]},{"id":"4701000200000","name":"\u041e\u0442\u0440\u0430\u0434\u043d\u043e\u0435","zip":187330,"type":"\u0413\u043e\u0440\u043e\u0434","typeShort":"\u0433","okato":"41225504000","contentType":"city","guid":"c4602384-ff62-4e0f-bf4b-06a5c653702b","ifnsfl":"4706","ifnsul":"4706","oktmo":"41625104001","parentGuid":"2a7ee036-942e-42ae-bbe3-d85901e5cfd6","cadnum":"","parents":[{"id":"4700000000000","name":"\u041b\u0435\u043d\u0438\u043d\u0433\u0440\u0430\u0434\u0441\u043a\u0430\u044f","zip":188514,"type":"\u041e\u0431\u043b\u0430\u0441\u0442\u044c","typeShort":"\u043e\u0431\u043b","okato":"41000000000","contentType":"region","guid":"6d1ebb35-70c6-4129-bd55-da3969658f5d","ifnsfl":"4700","ifnsul":"4700","oktmo":"41000000","parentGuid":"","cadnum":""},{"id":"4701000000000","name":"\u041a\u0438\u0440\u043e\u0432\u0441\u043a\u0438\u0439","zip":187350,"type":"\u0420\u0430\u0439\u043e\u043d","typeShort":"\u0440-\u043d","okato":"41225000000","contentType":"district","guid":"2a7ee036-942e-42ae-bbe3-d85901e5cfd6","ifnsfl":"","ifnsul":"","oktmo":"41625000","parentGuid":"6d1ebb35-70c6-4129-bd55-da3969658f5d","cadnum":""}]},{"id":"5301200100000","name":"\u041e\u043a\u0443\u043b\u043e\u0432\u043a\u0430","zip":174350,"type":"\u0413\u043e\u0440\u043e\u0434","typeShort":"\u0433","okato":"49228501000","contentType":"city","guid":"b9e66b8f-b027-4e77-8466-55ba3be0b42b","ifnsfl":"5300","ifnsul":"5300","oktmo":"49628101001","parentGuid":"a1bf6ac2-6525-4f4d-a8ab-98b21181a83b","cadnum":"","parents":[{"id":"5300000000000","name":"\u041d\u043e\u0432\u0433\u043e\u0440\u043e\u0434\u0441\u043a\u0430\u044f","zip":173000,"type":"\u041e\u0431\u043b\u0430\u0441\u0442\u044c","typeShort":"\u043e\u0431\u043b","okato":"49000000000","contentType":"region","guid":"e5a84b81-8ea1-49e3-b3c4-0528651be129","ifnsfl":"5300","ifnsul":"5300","oktmo":"49000000","parentGuid":"","cadnum":""},{"id":"5301200000000","name":"\u041e\u043a\u0443\u043b\u043e\u0432\u0441\u043a\u0438\u0439","zip":174350,"type":"\u0420\u0430\u0439\u043e\u043d","typeShort":"\u0440-\u043d","okato":"49228000000","contentType":"district","guid":"a1bf6ac2-6525-4f4d-a8ab-98b21181a83b","ifnsfl":"5300","ifnsul":"5300","oktmo":"49628000","parentGuid":"e5a84b81-8ea1-49e3-b3c4-0528651be129","cadnum":""}]},{"id":"5901900100000","name":"\u041e\u0447\u0435\u0440","zip":617140,"type":"\u0413\u043e\u0440\u043e\u0434","typeShort":"\u0433","okato":"57244501000","contentType":"city","guid":"6a9b1a8a-5da1-470c-a03a-ecbb3cee0ee9","ifnsfl":"5981","ifnsul":"5981","oktmo":"57762000001","parentGuid":"2e82fea7-7e6f-4c8a-849f-57140f80c7f3","cadnum":"","parents":[{"id":"5900000000000","name":"\u041f\u0435\u0440\u043c\u0441\u043a\u0438\u0439","zip":618719,"type":"\u041a\u0440\u0430\u0439","typeShort":"\u043a\u0440\u0430\u0439","okato":"57000000000","contentType":"region","guid":"4f8b1a21-e4bb-422f-9087-d3cbf4bebc14","ifnsfl":"5900","ifnsul":"5900","oktmo":"57000000","parentGuid":"","cadnum":""},{"id":"5901900000000","name":"\u041e\u0447\u0435\u0440\u0441\u043a\u0438\u0439","zip":617152,"type":"\u0420\u0430\u0439\u043e\u043d","typeShort":"\u0440-\u043d","okato":"57244000000","contentType":"district","guid":"2e82fea7-7e6f-4c8a-849f-57140f80c7f3","ifnsfl":"5981","ifnsul":"5981","oktmo":"57644000","parentGuid":"4f8b1a21-e4bb-422f-9087-d3cbf4bebc14","cadnum":""}]},{"id":"5901800100000","name":"\u041e\u0445\u0430\u043d\u0441\u043a","zip":618100,"type":"\u0413\u043e\u0440\u043e\u0434","typeShort":"\u0433","okato":"57242501000","contentType":"city","guid":"48159476-c6db-4258-a0bc-f8ee52e7aef6","ifnsfl":"5981","ifnsul":"5981","oktmo":"57729000001","parentGuid":"e7012a7a-e7de-4306-8f52-aabeaf82f178","cadnum":"","parents":[{"id":"5900000000000","name":"\u041f\u0435\u0440\u043c\u0441\u043a\u0438\u0439","zip":618719,"type":"\u041a\u0440\u0430\u0439","typeShort":"\u043a\u0440\u0430\u0439","okato":"57000000000","contentType":"region","guid":"4f8b1a21-e4bb-422f-9087-d3cbf4bebc14","ifnsfl":"5900","ifnsul":"5900","oktmo":"57000000","parentGuid":"","cadnum":""},{"id":"5901800000000","name":"\u041e\u0445\u0430\u043d\u0441\u043a\u0438\u0439","zip":618111,"type":"\u0420\u0430\u0439\u043e\u043d","typeShort":"\u0440-\u043d","okato":"57242000000","contentType":"district","guid":"e7012a7a-e7de-4306-8f52-aabeaf82f178","ifnsfl":"5981","ifnsul":"5981","oktmo":"57642000","parentGuid":"4f8b1a21-e4bb-422f-9087-d3cbf4bebc14","cadnum":""}]},{"id":"5901600100000","name":"\u041e\u0441\u0430","zip":619430,"type":"\u0413\u043e\u0440\u043e\u0434","typeShort":"\u0433","okato":"57240501000","contentType":"city","guid":"18e7b084-c83f-40bf-9378-d26628528a19","ifnsfl":"5959","ifnsul":"5959","oktmo":"57728000001","parentGuid":"60dd742a-3dc9-4ab1-9a22-12c19efdb340","cadnum":"","parents":[{"id":"5900000000000","name":"\u041f\u0435\u0440\u043c\u0441\u043a\u0438\u0439","zip":618719,"type":"\u041a\u0440\u0430\u0439","typeShort":"\u043a\u0440\u0430\u0439","okato":"57000000000","contentType":"region","guid":"4f8b1a21-e4bb-422f-9087-d3cbf4bebc14","ifnsfl":"5900","ifnsul":"5900","oktmo":"57000000","parentGuid":"","cadnum":""},{"id":"5901600000000","name":"\u041e\u0441\u0438\u043d\u0441\u043a\u0438\u0439","zip":618124,"type":"\u0420\u0430\u0439\u043e\u043d","typeShort":"\u0440-\u043d","okato":"57240000000","contentType":"district","guid":"60dd742a-3dc9-4ab1-9a22-12c19efdb340","ifnsfl":"5959","ifnsul":"5959","oktmo":"57640000","parentGuid":"4f8b1a21-e4bb-422f-9087-d3cbf4bebc14","cadnum":""}]},{"id":"6001300100000","name":"\u041e\u043f\u043e\u0447\u043a\u0430","zip":182330,"type":"\u0413\u043e\u0440\u043e\u0434","typeShort":"\u0433","okato":"58229501000","contentType":"city","guid":"59c2f176-3b63-4086-bc6c-efa246c64a1e","ifnsfl":"6032","ifnsul":"6032","oktmo":"58629101001","parentGuid":"259a2f66-9d5d-4db0-94f5-af961ca9132d","cadnum":"","parents":[{"id":"6000000000000","name":"\u041f\u0441\u043a\u043e\u0432\u0441\u043a\u0430\u044f","zip":180020,"type":"\u041e\u0431\u043b\u0430\u0441\u0442\u044c","typeShort":"\u043e\u0431\u043b","okato":"58000000000","contentType":"region","guid":"f6e148a1-c9d0-4141-a608-93e3bd95e6c4","ifnsfl":"6000","ifnsul":"6000","oktmo":"58000000","parentGuid":"","cadnum":""},{"id":"6001300000000","name":"\u041e\u043f\u043e\u0447\u0435\u0446\u043a\u0438\u0439","zip":182340,"type":"\u0420\u0430\u0439\u043e\u043d","typeShort":"\u0440-\u043d","okato":"58229000000","contentType":"district","guid":"259a2f66-9d5d-4db0-94f5-af961ca9132d","ifnsfl":"6032","ifnsul":"6032","oktmo":"58629000","parentGuid":"f6e148a1-c9d0-4141-a608-93e3bd95e6c4","cadnum":""}]},{"id":"6001400100000","name":"\u041e\u0441\u0442\u0440\u043e\u0432","zip":181350,"type":"\u0413\u043e\u0440\u043e\u0434","typeShort":"\u0433","okato":"58233501000","contentType":"city","guid":"67d379ab-16ac-40d0-95c0-f5f1cbeb578d","ifnsfl":"6032","ifnsul":"6032","oktmo":"58633101001","parentGuid":"2c4fa4ca-1868-42ef-8951-12943c5686ff","cadnum":"","parents":[{"id":"6000000000000","name":"\u041f\u0441\u043a\u043e\u0432\u0441\u043a\u0430\u044f","zip":180020,"type":"\u041e\u0431\u043b\u0430\u0441\u0442\u044c","typeShort":"\u043e\u0431\u043b","okato":"58000000000","contentType":"region","guid":"f6e148a1-c9d0-4141-a608-93e3bd95e6c4","ifnsfl":"6000","ifnsul":"6000","oktmo":"58000000","parentGuid":"","cadnum":""},{"id":"6001400000000","name":"\u041e\u0441\u0442\u0440\u043e\u0432\u0441\u043a\u0438\u0439","zip":181301,"type":"\u0420\u0430\u0439\u043e\u043d","typeShort":"\u0440-\u043d","okato":"58233000000","contentType":"district","guid":"2c4fa4ca-1868-42ef-8951-12943c5686ff","ifnsfl":"6032","ifnsul":"6032","oktmo":"58633000","parentGuid":"f6e148a1-c9d0-4141-a608-93e3bd95e6c4","cadnum":""}]},{"id":"6500900100000","name":"\u041e\u0445\u0430","zip":694496,"type":"\u0413\u043e\u0440\u043e\u0434","typeShort":"\u0433","okato":"64236501000","contentType":"city","guid":"273e561f-aa3b-4057-9225-862563c93287","ifnsfl":"6517","ifnsul":"6517","oktmo":"64736000001","parentGuid":"efb555f4-2f2a-49af-a40c-d398cbc84271","cadnum":"","parents":[{"id":"6500000000000","name":"\u0421\u0430\u0445\u0430\u043b\u0438\u043d\u0441\u043a\u0430\u044f","zip":693000,"type":"\u041e\u0431\u043b\u0430\u0441\u0442\u044c","typeShort":"\u043e\u0431\u043b","okato":"64000000000","contentType":"region","guid":"aea6280f-4648-460f-b8be-c2bc18923191","ifnsfl":"6500","ifnsul":"6500","oktmo":"64000000","parentGuid":"","cadnum":""},{"id":"6500900000000","name":"\u041e\u0445\u0438\u043d\u0441\u043a\u0438\u0439","zip":694463,"type":"\u0420\u0430\u0439\u043e\u043d","typeShort":"\u0440-\u043d","okato":"64236000000","contentType":"district","guid":"efb555f4-2f2a-49af-a40c-d398cbc84271","ifnsfl":"6517","ifnsul":"6517","oktmo":"64736000","parentGuid":"aea6280f-4648-460f-b8be-c2bc18923191","cadnum":""}]},{"id":"7900300100000","name":"\u041e\u0431\u043b\u0443\u0447\u044c\u0435","zip":679102,"type":"\u0413\u043e\u0440\u043e\u0434","typeShort":"\u0433","okato":"99220501000","contentType":"city","guid":"b60c1e9f-9355-47ef-b5a3-82906d074bd4","ifnsfl":"7900","ifnsul":"7900","oktmo":"99620101001","parentGuid":"5d1d4108-c914-4680-8330-962bda49c14a","cadnum":"","parents":[{"id":"7900000000000","name":"\u0415\u0432\u0440\u0435\u0439\u0441\u043a\u0430\u044f","zip":679016,"type":"\u0410\u0432\u0442\u043e\u043d\u043e\u043c\u043d\u0430\u044f \u043e\u0431\u043b\u0430\u0441\u0442\u044c","typeShort":"\u0410\u043e\u0431\u043b","okato":"99000000000","contentType":"region","guid":"1b507b09-48c9-434f-bf6f-65066211c73e","ifnsfl":"7900","ifnsul":"7900","oktmo":"99000000","parentGuid":"","cadnum":""},{"id":"7900300000000","name":"\u041e\u0431\u043b\u0443\u0447\u0435\u043d\u0441\u043a\u0438\u0439","zip":679145,"type":"\u0420\u0430\u0439\u043e\u043d","typeShort":"\u0440-\u043d","okato":"99220000000","contentType":"district","guid":"5d1d4108-c914-4680-8330-962bda49c14a","ifnsfl":"7900","ifnsul":"7900","oktmo":"","parentGuid":"1b507b09-48c9-434f-bf6f-65066211c73e","cadnum":""}]},{"id":"5000100000000","name":"\u041e\u0440\u0435\u0445\u043e\u0432\u043e-\u0417\u0443\u0435\u0432\u043e","zip":142608,"type":"\u0413\u043e\u0440\u043e\u0434","typeShort":"\u0433","okato":"46457000000","contentType":"city","guid":"0f2f2d09-8e7a-4356-bd4d-0b055d802e7b","ifnsfl":"5034","ifnsul":"5034","oktmo":"46757000001","parentGuid":"29251dcf-00a1-4e34-98d4-5c47484a36d4","cadnum":"","parents":[{"id":"5000000000000","name":"\u041c\u043e\u0441\u043a\u043e\u0432\u0441\u043a\u0430\u044f","zip":143562,"type":"\u041e\u0431\u043b\u0430\u0441\u0442\u044c","typeShort":"\u043e\u0431\u043b","okato":"46000000000","contentType":"region","guid":"29251dcf-00a1-4e34-98d4-5c47484a36d4","ifnsfl":"5000","ifnsul":"5000","oktmo":"46000000","parentGuid":"","cadnum":""},{"id":"5000100000000","name":"\u041e\u0440\u0435\u0445\u043e\u0432\u043e-\u0417\u0443\u0435\u0432\u043e","zip":142608,"type":"\u0413\u043e\u0440\u043e\u0434","typeShort":"\u0433","okato":"46457000000","contentType":"district","guid":"0f2f2d09-8e7a-4356-bd4d-0b055d802e7b","ifnsfl":"5034","ifnsul":"5034","oktmo":"46757000001","parentGuid":"29251dcf-00a1-4e34-98d4-5c47484a36d4","cadnum":""}]},{"id":"5004200000000","name":"\u041e\u0434\u0438\u043d\u0446\u043e\u0432\u043e","zip":143039,"type":"\u0413\u043e\u0440\u043e\u0434","typeShort":"\u0433","okato":"46455000000","contentType":"city","guid":"6ae8ad9e-aa6c-4849-92d8-8e637059c9b0","ifnsfl":"5032","ifnsul":"5032","oktmo":"46755000001","parentGuid":"29251dcf-00a1-4e34-98d4-5c47484a36d4","cadnum":"","parents":[{"id":"5000000000000","name":"\u041c\u043e\u0441\u043a\u043e\u0432\u0441\u043a\u0430\u044f","zip":143562,"type":"\u041e\u0431\u043b\u0430\u0441\u0442\u044c","typeShort":"\u043e\u0431\u043b","okato":"46000000000","contentType":"region","guid":"29251dcf-00a1-4e34-98d4-5c47484a36d4","ifnsfl":"5000","ifnsul":"5000","oktmo":"46000000","parentGuid":"","cadnum":""},{"id":"5004200000000","name":"\u041e\u0434\u0438\u043d\u0446\u043e\u0432\u043e","zip":143039,"type":"\u0413\u043e\u0440\u043e\u0434","typeShort":"\u0433","okato":"46455000000","contentType":"district","guid":"6ae8ad9e-aa6c-4849-92d8-8e637059c9b0","ifnsfl":"5032","ifnsul":"5032","oktmo":"46755000001","parentGuid":"29251dcf-00a1-4e34-98d4-5c47484a36d4","cadnum":""}]},{"id":"0200000400000","name":"\u041e\u043a\u0442\u044f\u0431\u0440\u044c\u0441\u043a\u0438\u0439","zip":452615,"type":"\u0413\u043e\u0440\u043e\u0434","typeShort":"\u0433","okato":"80435000000","contentType":"city","guid":"abd1bc35-ec51-437a-abee-76a4f620f662","ifnsfl":"0269","ifnsul":"0269","oktmo":"80735000001","parentGuid":"6f2cbfd8-692a-4ee4-9b16-067210bde3fc","cadnum":"","parents":[{"id":"0200000000000","name":"\u0411\u0430\u0448\u043a\u043e\u0440\u0442\u043e\u0441\u0442\u0430\u043d","zip":450019,"type":"\u0420\u0435\u0441\u043f\u0443\u0431\u043b\u0438\u043a\u0430","typeShort":"\u0420\u0435\u0441\u043f","okato":"80000000000","contentType":"region","guid":"6f2cbfd8-692a-4ee4-9b16-067210bde3fc","ifnsfl":"0200","ifnsul":"0200","oktmo":"80000000","parentGuid":"","cadnum":""}]},{"id":"0500000200000","name":"\u0414\u0430\u0433\u0435\u0441\u0442\u0430\u043d\u0441\u043a\u0438\u0435 \u041e\u0433\u043d\u0438","zip":368670,"type":"\u0413\u043e\u0440\u043e\u0434","typeShort":"\u0433","okato":"82408000000","contentType":"city","guid":"8b4a997b-1e70-402a-a56a-e93c81d0ff20","ifnsfl":"0550","ifnsul":"0550","oktmo":"82708000001","parentGuid":"0bb7fa19-736d-49cf-ad0e-9774c4dae09b","cadnum":"","parents":[{"id":"0500000000000","name":"\u0414\u0430\u0433\u0435\u0441\u0442\u0430\u043d","zip":367009,"type":"\u0420\u0435\u0441\u043f\u0443\u0431\u043b\u0438\u043a\u0430","typeShort":"\u0420\u0435\u0441\u043f","okato":"82000000000","contentType":"region","guid":"0bb7fa19-736d-49cf-ad0e-9774c4dae09b","ifnsfl":"0500","ifnsul":"0500","oktmo":"82000000","parentGuid":"","cadnum":""}]},{"id":"3100000200000","name":"\u0421\u0442\u0430\u0440\u044b\u0439 \u041e\u0441\u043a\u043e\u043b","zip":309500,"type":"\u0413\u043e\u0440\u043e\u0434","typeShort":"\u0433","okato":"14440000000","contentType":"city","guid":"9f5e86b1-b893-43dc-9dd4-ac66573b17d1","ifnsfl":"3128","ifnsul":"3128","oktmo":"14740000001","parentGuid":"639efe9d-3fc8-4438-8e70-ec4f2321f2a7","cadnum":"","parents":[{"id":"3100000000000","name":"\u0411\u0435\u043b\u0433\u043e\u0440\u043e\u0434\u0441\u043a\u0430\u044f","zip":308024,"type":"\u041e\u0431\u043b\u0430\u0441\u0442\u044c","typeShort":"\u043e\u0431\u043b","okato":"14000000000","contentType":"region","guid":"639efe9d-3fc8-4438-8e70-ec4f2321f2a7","ifnsfl":"3100","ifnsul":"3100","oktmo":"14000000","parentGuid":"","cadnum":""}]},{"id":"4000000200000","name":"\u041e\u0431\u043d\u0438\u043d\u0441\u043a","zip":249032,"type":"\u0413\u043e\u0440\u043e\u0434","typeShort":"\u0433","okato":"29415000000","contentType":"city","guid":"05a647ff-b859-4c93-8c8e-3590110a0085","ifnsfl":"4025","ifnsul":"4025","oktmo":"29715000001","parentGuid":"18133adf-90c2-438e-88c4-62c41656de70","cadnum":"","parents":[{"id":"4000000000000","name":"\u041a\u0430\u043b\u0443\u0436\u0441\u043a\u0430\u044f","zip":248012,"type":"\u041e\u0431\u043b\u0430\u0441\u0442\u044c","typeShort":"\u043e\u0431\u043b","okato":"29000000000","contentType":"region","guid":"18133adf-90c2-438e-88c4-62c41656de70","ifnsfl":"4000","ifnsul":"4000","oktmo":"29000000","parentGuid":"","cadnum":""}]},{"id":"4200000700000","name":"\u041e\u0441\u0438\u043d\u043d\u0438\u043a\u0438","zip":652800,"type":"\u0413\u043e\u0440\u043e\u0434","typeShort":"\u0433","okato":"32434000000","contentType":"city","guid":"1efff7c4-448a-48c5-b476-c803b4d36842","ifnsfl":"4214","ifnsul":"4214","oktmo":"32734000001","parentGuid":"393aeccb-89ef-4a7e-ae42-08d5cebc2e30","cadnum":"","parents":[{"id":"4200000000000","name":"\u041a\u0435\u043c\u0435\u0440\u043e\u0432\u0441\u043a\u0430\u044f \u043e\u0431\u043b\u0430\u0441\u0442\u044c - \u041a\u0443\u0437\u0431\u0430\u0441\u0441","zip":652088,"type":"\u041e\u0431\u043b\u0430\u0441\u0442\u044c","typeShort":"\u043e\u0431\u043b","okato":"32000000000","contentType":"region","guid":"393aeccb-89ef-4a7e-ae42-08d5cebc2e30","ifnsfl":"4200","ifnsul":"4200","oktmo":"32000000","parentGuid":"","cadnum":""}]},{"id":"5000004000000","name":"\u041e\u0437\u0451\u0440\u044b","zip":140560,"type":"\u0413\u043e\u0440\u043e\u0434","typeShort":"\u0433","okato":"46456000000","contentType":"city","guid":"e778b800-b432-4150-82fd-d415911fb700","ifnsfl":"5022","ifnsul":"5022","oktmo":"46756000001","parentGuid":"29251dcf-00a1-4e34-98d4-5c47484a36d4","cadnum":"","parents":[{"id":"5000000000000","name":"\u041c\u043e\u0441\u043a\u043e\u0432\u0441\u043a\u0430\u044f","zip":143562,"type":"\u041e\u0431\u043b\u0430\u0441\u0442\u044c","typeShort":"\u043e\u0431\u043b","okato":"46000000000","contentType":"region","guid":"29251dcf-00a1-4e34-98d4-5c47484a36d4","ifnsfl":"5000","ifnsul":"5000","oktmo":"46000000","parentGuid":"","cadnum":""}]},{"id":"5100001500000","name":"\u041e\u043b\u0435\u043d\u0435\u0433\u043e\u0440\u0441\u043a-1","zip":184530,"type":"\u0413\u043e\u0440\u043e\u0434","typeShort":"\u0433","okato":"47417000000","contentType":"city","guid":"d9553f4e-bbf6-4cc2-8f82-523a56265e56","ifnsfl":"5108","ifnsul":"5108","oktmo":"47717000001","parentGuid":"1c727518-c96a-4f34-9ae6-fd510da3be03","cadnum":"","parents":[{"id":"5100000000000","name":"\u041c\u0443\u0440\u043c\u0430\u043d\u0441\u043a\u0430\u044f","zip":184372,"type":"\u041e\u0431\u043b\u0430\u0441\u0442\u044c","typeShort":"\u043e\u0431\u043b","okato":"47000000000","contentType":"region","guid":"1c727518-c96a-4f34-9ae6-fd510da3be03","ifnsfl":"5100","ifnsul":"5100","oktmo":"47000000","parentGuid":"","cadnum":""}]},{"id":"5100000700000","name":"\u041e\u043b\u0435\u043d\u0435\u0433\u043e\u0440\u0441\u043a","zip":184530,"type":"\u0413\u043e\u0440\u043e\u0434","typeShort":"\u0433","okato":"47417000000","contentType":"city","guid":"c5fe1817-5163-4e3b-b06a-36d322c6bf57","ifnsfl":"5108","ifnsul":"5108","oktmo":"47717000001","parentGuid":"1c727518-c96a-4f34-9ae6-fd510da3be03","cadnum":"","parents":[{"id":"5100000000000","name":"\u041c\u0443\u0440\u043c\u0430\u043d\u0441\u043a\u0430\u044f","zip":184372,"type":"\u041e\u0431\u043b\u0430\u0441\u0442\u044c","typeShort":"\u043e\u0431\u043b","okato":"47000000000","contentType":"region","guid":"1c727518-c96a-4f34-9ae6-fd510da3be03","ifnsfl":"5100","ifnsul":"5100","oktmo":"47000000","parentGuid":"","cadnum":""}]},{"id":"5100001600000","name":"\u041e\u043b\u0435\u043d\u0435\u0433\u043e\u0440\u0441\u043a-2","zip":184532,"type":"\u0413\u043e\u0440\u043e\u0434","typeShort":"\u0433","okato":"47417000000","contentType":"city","guid":"defed7b3-d1f0-4dbb-baa8-03bdaffa2b18","ifnsfl":"5108","ifnsul":"5108","oktmo":"47717000001","parentGuid":"1c727518-c96a-4f34-9ae6-fd510da3be03","cadnum":"","parents":[{"id":"5100000000000","name":"\u041c\u0443\u0440\u043c\u0430\u043d\u0441\u043a\u0430\u044f","zip":184372,"type":"\u041e\u0431\u043b\u0430\u0441\u0442\u044c","typeShort":"\u043e\u0431\u043b","okato":"47000000000","contentType":"region","guid":"1c727518-c96a-4f34-9ae6-fd510da3be03","ifnsfl":"5100","ifnsul":"5100","oktmo":"47000000","parentGuid":"","cadnum":""}]},{"id":"5100000800000","name":"\u041e\u0441\u0442\u0440\u043e\u0432\u043d\u043e\u0439","zip":184640,"type":"\u0413\u043e\u0440\u043e\u0434","typeShort":"\u0433","okato":"47531000000","contentType":"city","guid":"0a358e8a-d3c4-45e5-b9fc-126092afd6f5","ifnsfl":"5110","ifnsul":"5110","oktmo":"47731000","parentGuid":"1c727518-c96a-4f34-9ae6-fd510da3be03","cadnum":"","parents":[{"id":"5100000000000","name":"\u041c\u0443\u0440\u043c\u0430\u043d\u0441\u043a\u0430\u044f","zip":184372,"type":"\u041e\u0431\u043b\u0430\u0441\u0442\u044c","typeShort":"\u043e\u0431\u043b","okato":"47000000000","contentType":"region","guid":"1c727518-c96a-4f34-9ae6-fd510da3be03","ifnsfl":"5100","ifnsul":"5100","oktmo":"47000000","parentGuid":"","cadnum":""}]},{"id":"5400000300000","name":"\u041e\u0431\u044c","zip":633102,"type":"\u0413\u043e\u0440\u043e\u0434","typeShort":"\u0433","okato":"50417000000","contentType":"city","guid":"8571e389-8c43-4c36-afae-b532d078c928","ifnsfl":"5410","ifnsul":"5410","oktmo":"50717000001","parentGuid":"1ac46b49-3209-4814-b7bf-a509ea1aecd9","cadnum":"","parents":[{"id":"5400000000000","name":"\u041d\u043e\u0432\u043e\u0441\u0438\u0431\u0438\u0440\u0441\u043a\u0430\u044f","zip":630545,"type":"\u041e\u0431\u043b\u0430\u0441\u0442\u044c","typeShort":"\u043e\u0431\u043b","okato":"50000000000","contentType":"region","guid":"1ac46b49-3209-4814-b7bf-a509ea1aecd9","ifnsfl":"5400","ifnsul":"5400","oktmo":"50000000","parentGuid":"","cadnum":""}]},{"id":"5500000100000","name":"\u041e\u043c\u0441\u043a","zip":644009,"type":"\u0413\u043e\u0440\u043e\u0434","typeShort":"\u0433","okato":"52401000000","contentType":"city","guid":"140e31da-27bf-4519-9ea0-6185d681d44e","ifnsfl":"","ifnsul":"","oktmo":"52701000001","parentGuid":"05426864-466d-41a3-82c4-11e61cdc98ce","cadnum":"","parents":[{"id":"5500000000000","name":"\u041e\u043c\u0441\u043a\u0430\u044f","zip":644009,"type":"\u041e\u0431\u043b\u0430\u0441\u0442\u044c","typeShort":"\u043e\u0431\u043b","okato":"52000000000","contentType":"region","guid":"05426864-466d-41a3-82c4-11e61cdc98ce","ifnsfl":"5500","ifnsul":"5500","oktmo":"52000000","parentGuid":"","cadnum":""}]},{"id":"5600000100000","name":"\u041e\u0440\u0435\u043d\u0431\u0443\u0440\u0433","zip":460035,"type":"\u0413\u043e\u0440\u043e\u0434","typeShort":"\u0433","okato":"53401000000","contentType":"city","guid":"dce97bff-deb2-4fd9-9aec-4f4327bbf89b","ifnsfl":"","ifnsul":"","oktmo":"53701000001","parentGuid":"8bcec9d6-05bc-4e53-b45c-ba0c6f3a5c44","cadnum":"","parents":[{"id":"5600000000000","name":"\u041e\u0440\u0435\u043d\u0431\u0443\u0440\u0433\u0441\u043a\u0430\u044f","zip":462781,"type":"\u041e\u0431\u043b\u0430\u0441\u0442\u044c","typeShort":"\u043e\u0431\u043b","okato":"53000000000","contentType":"region","guid":"8bcec9d6-05bc-4e53-b45c-ba0c6f3a5c44","ifnsfl":"5600","ifnsul":"5600","oktmo":"53000000","parentGuid":"","cadnum":""}]},{"id":"5600000400000","name":"\u041e\u0440\u0441\u043a","zip":462429,"type":"\u0413\u043e\u0440\u043e\u0434","typeShort":"\u0433","okato":"53423000000","contentType":"city","guid":"71e7cb45-f365-4e6b-b068-a7d35349c3ba","ifnsfl":"5614","ifnsul":"5614","oktmo":"53723000001","parentGuid":"8bcec9d6-05bc-4e53-b45c-ba0c6f3a5c44","cadnum":"","parents":[{"id":"5600000000000","name":"\u041e\u0440\u0435\u043d\u0431\u0443\u0440\u0433\u0441\u043a\u0430\u044f","zip":462781,"type":"\u041e\u0431\u043b\u0430\u0441\u0442\u044c","typeShort":"\u043e\u0431\u043b","okato":"53000000000","contentType":"region","guid":"8bcec9d6-05bc-4e53-b45c-ba0c6f3a5c44","ifnsfl":"5600","ifnsul":"5600","oktmo":"53000000","parentGuid":"","cadnum":""}]},{"id":"5700000100000","name":"\u041e\u0440\u0451\u043b","zip":302042,"type":"\u0413\u043e\u0440\u043e\u0434","typeShort":"\u0433","okato":"54401000000","contentType":"city","guid":"2abed4d9-5565-4885-bc96-f4ffccc6cba4","ifnsfl":"5740","ifnsul":"5740","oktmo":"54701000001","parentGuid":"5e465691-de23-4c4e-9f46-f35a125b5970","cadnum":"","parents":[{"id":"5700000000000","name":"\u041e\u0440\u043b\u043e\u0432\u0441\u043a\u0430\u044f","zip":302042,"type":"\u041e\u0431\u043b\u0430\u0441\u0442\u044c","typeShort":"\u043e\u0431\u043b","okato":"54000000000","contentType":"region","guid":"5e465691-de23-4c4e-9f46-f35a125b5970","ifnsfl":"5700","ifnsul":"5700","oktmo":"54000000","parentGuid":"","cadnum":""}]},{"id":"6300000400000","name":"\u041e\u043a\u0442\u044f\u0431\u0440\u044c\u0441\u043a","zip":445240,"type":"\u0413\u043e\u0440\u043e\u0434","typeShort":"\u0433","okato":"36418000000","contentType":"city","guid":"b9a43610-5c01-4ba8-8de7-95facc7e460d","ifnsfl":"6325","ifnsul":"6325","oktmo":"36718000001","parentGuid":"df3d7359-afa9-4aaa-8ff9-197e73906b1c","cadnum":"","parents":[{"id":"6300000000000","name":"\u0421\u0430\u043c\u0430\u0440\u0441\u043a\u0430\u044f","zip":443066,"type":"\u041e\u0431\u043b\u0430\u0441\u0442\u044c","typeShort":"\u043e\u0431\u043b","okato":"36000000000","contentType":"region","guid":"df3d7359-afa9-4aaa-8ff9-197e73906b1c","ifnsfl":"6300","ifnsul":"6300","oktmo":"36000000","parentGuid":"","cadnum":""}]},{"id":"6300000500000","name":"\u041e\u0442\u0440\u0430\u0434\u043d\u044b\u0439","zip":446305,"type":"\u0413\u043e\u0440\u043e\u0434","typeShort":"\u0433","okato":"36424000000","contentType":"city","guid":"05edd5aa-ab64-4afa-b56c-fd5661a14129","ifnsfl":"6372","ifnsul":"6372","oktmo":"36724000001","parentGuid":"df3d7359-afa9-4aaa-8ff9-197e73906b1c","cadnum":"","parents":[{"id":"6300000000000","name":"\u0421\u0430\u043c\u0430\u0440\u0441\u043a\u0430\u044f","zip":443066,"type":"\u041e\u0431\u043b\u0430\u0441\u0442\u044c","typeShort":"\u043e\u0431\u043b","okato":"36000000000","contentType":"region","guid":"df3d7359-afa9-4aaa-8ff9-197e73906b1c","ifnsfl":"6300","ifnsul":"6300","oktmo":"36000000","parentGuid":"","cadnum":""}]},{"id":"6900000800000","name":"\u041e\u0441\u0442\u0430\u0448\u043a\u043e\u0432","zip":172730,"type":"\u0413\u043e\u0440\u043e\u0434","typeShort":"\u0433","okato":"28440000000","contentType":"city","guid":"bfe4c46e-0487-48ba-aea3-be0d909fca67","ifnsfl":"6913","ifnsul":"6913","oktmo":"28752000001","parentGuid":"61723327-1c20-42fe-8dfa-402638d9b396","cadnum":"","parents":[{"id":"6900000000000","name":"\u0422\u0432\u0435\u0440\u0441\u043a\u0430\u044f","zip":171090,"type":"\u041e\u0431\u043b\u0430\u0441\u0442\u044c","typeShort":"\u043e\u0431\u043b","okato":"28000000000","contentType":"region","guid":"61723327-1c20-42fe-8dfa-402638d9b396","ifnsfl":"6900","ifnsul":"6900","oktmo":"28000000","parentGuid":"","cadnum":""}]},{"id":"7400001100000","name":"\u041e\u0437\u0435\u0440\u0441\u043a","zip":456784,"type":"\u0413\u043e\u0440\u043e\u0434","typeShort":"\u0433","okato":"75543000000","contentType":"city","guid":"8192c863-edbf-4825-8523-0612ae80e5a7","ifnsfl":"7413","ifnsul":"7413","oktmo":"75743000001","parentGuid":"27eb7c10-a234-44da-a59c-8b1f864966de","cadnum":"","parents":[{"id":"7400000000000","name":"\u0427\u0435\u043b\u044f\u0431\u0438\u043d\u0441\u043a\u0430\u044f","zip":457390,"type":"\u041e\u0431\u043b\u0430\u0441\u0442\u044c","typeShort":"\u043e\u0431\u043b","okato":"75000000000","contentType":"region","guid":"27eb7c10-a234-44da-a59c-8b1f864966de","ifnsfl":"7400","ifnsul":"7400","oktmo":"75000000","parentGuid":"","cadnum":""}]}]}

    // Если поле поиска пустое, то очищаем массив городов
    useEffect( () => {
        if (props.searchQuery.searchQuery.length == 0) {
            setCitiesList([])
            setIsCitiesLoading(true)
        }
    }, [props.searchQuery.searchQuery])

    const [citiesList, setCitiesList] = useState([])
    const [isCitiesLoading, setIsCitiesLoading] = useState(true)

    let fias = {}
    fias.token = 'fQDFRdaNyRByKDey9a8Ksa9QZQs6GR2N';
    // fias.beforeUrl = 'https://cors-anywhere.herokuapp.com/';
    fias.beforeUrl = '';
    fias.url = fias.beforeUrl + 'https://kladr-api.ru/api.php?query=' + props.searchQuery.searchQuery + '&contentType=city&withParent=1&typeCode=1&token=' + fias.token

    let getCitiesList = []
        // setIsCitiesLoading(true)
    async function fetchCities() {
        // setIsCitiesLoading(true)

        getCitiesList = await DataServiceClass.getAll(fias.url)
        // console.log('fias.url: ', fias.url)
        // console.dir(citiesList)
        if (getCitiesList) {
            setCitiesList(getCitiesList)
        }
        setIsCitiesLoading(false)
    }

    let citiesData = citiesList
    // Получаем тестовый массив, если не обходится CORS
    // let citiesData = citiesLocal
    // console.log('citiesData: ', citiesData);


    const  citiesNames = citiesData.result ? citiesData.result.filter(el => el.id != 'Free').map(el => el.name) : [];
    // console.dir(citiesNames);

    // Если в строке поиска ввели первую букву, то загружаем массив городов
    if (props.searchQuery.searchQuery.length === 1 && citiesData.length == 0) {

        setTimeout(() => { // Для примера долгой загрузки
            fetchCities(props.searchQuery.searchQuery)
        }, 2000);

    }
    const searchedCities = useMemo( () => {
        // console.log('props.searchQuery: ', props.searchQuery.searchQuery)
        // console.log('citiesNames: ', citiesNames.filter(citiesNames => citiesNames.toLowerCase().includes(props.searchQuery.searchQuery.toLowerCase())))
        return citiesNames.filter(citiesNames => citiesNames.toLowerCase().includes(props.searchQuery.searchQuery.toLowerCase()))
    }, [props.searchQuery.searchQuery, citiesNames])

    let filterCities = citiesNames.filter(citiesNames => citiesNames.toLowerCase().includes(props.searchQuery.searchQuery.toLowerCase()))

    const cityChoiceContent = document.querySelector('.cityChoice__content');
    const cityChoiceList = document.querySelector('.cityChoice__list');
    document.addEventListener('click', (e) => {
        const click = e.composedPath().includes(cityChoiceContent);
        if (!click) {
            cityChoiceList.className = listClassName(false)
        }
        else {
            cityChoiceList.className = listClassName(true)
        }
    })

    const searchSubstringBefore = (str) => {
        if (props.searchQuery.searchQuery == '') {
            return str
        }
        else {
            // console.log("props.searchQuery.searchQuery: ", props.searchQuery.searchQuery)
            const beforeCount = str.toLowerCase().indexOf(props.searchQuery.searchQuery.toLowerCase())
            if (beforeCount == 0) {
                return ''
            }
            else {
                return str.slice(0, beforeCount)
            }

        }
    }

    // Сохраняем регистр подстроки, совпадающей с поисковым запросом
    const searchSubstring = (str) => {
        if (props.searchQuery.searchQuery == '') {
            return ''
        }
        else {
            const beforeCount = str.toLowerCase().indexOf(props.searchQuery.searchQuery.toLowerCase())
            return str.slice(beforeCount, beforeCount + props.searchQuery.searchQuery.length)
        }
    }

    const searchSubstringAfter = (str) => {
        if (props.searchQuery.searchQuery == '') {
            return ''
        }
        else {
            const beforeCount = str.toLowerCase().indexOf(props.searchQuery.searchQuery.toLowerCase()) + props.searchQuery.searchQuery.length
            return str.slice(beforeCount)
        }
    }

    let listClassName = (show) => {
        // console.log('show: ', show)
        // console.log('showCitiesList: ', showCitiesList)
        // console.log('searchQuery: ', props.searchQuery.searchQuery)
        if (props.searchQuery.searchQuery == '' || !show){
            return 'cityChoice__list'
        }
        else {
            return 'cityChoice__list cityChoice__list_active'
        }

    }

    const cityReady =  function (e)  {
        e.preventDefault();
        // console.log(this)
        props.city(this)
    }


    return (

        <div className={"cityChoice__contaner"}>

            <ul className={listClassName(true)}>
                {
                    isCitiesLoading
                    ?
                        <li className={"cityChoice__item cityChoice__item_load"}>Ищем...</li>
                    :
                        !filterCities.length
                            ?
                                <li className={"error"} onClick={cityReady.bind('')}>
                                    Нет такого города
                                </li>
                            :
                                searchedCities.map((el, index) =>
                                    // filterCities.map((el, index) =>
                                    <li
                                        key={index}
                                        // key={el.id} // В объекте id не уникальны
                                        onClick={cityReady.bind(el)}
                                        className={"cityChoice__item"}
                                    >
                                        {searchSubstringBefore(el)}
                                        <span className={"cityChoice__search"}>
                                            {searchSubstring(el)}
                                        </span>
                                        {searchSubstringAfter(el)}

                                    </li>
                                )
                }
            </ul>
        </div>

    );
};

export default CitiesList;